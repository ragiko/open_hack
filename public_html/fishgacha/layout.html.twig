<!--<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>おさかな天国（仮）</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">


    <link href="{{ asset('/bower_components/bootstrap/dist/css/bootstrap.css') }}" rel="stylesheet">
    <style>
      body {
      padding-top: 70px;
      padding-bottom: 30px;
      }

      .theme-dropdown .dropdown-menu {
      position: static;
      display: block;
      margin-bottom: 20px;
      }

      .theme-showcase > p > .btn {
      margin: 5px 0;
      }
    </style>
  </head>

  <body role="document">


    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="{{ urlFor('welcome') }}">GroupWorkBase</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Guide <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="{{ urlFor('doc_top') }}">リンク一覧</a></li>
                <li class="divider"></li>
                <li class="dropdown-header">Backend</li>
                <li><a href="{{ urlFor('doc_basic') }}">基本構成</a></li>
                <li><a href="{{ urlFor('doc_extend') }}">用意された拡張</a></li>
                <li class="dropdown-header">Frontend</li>
                <li><a href="/front/">GroupWorkBase Front</a></li>
              </ul>
            </li>
          </ul>
          <ul class="nav navbar-nav">
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Demo <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="{{ urlFor('doc_bootstrap') }}">bootstrap</a></li>
                <li><a href="{{ urlFor('hello', {'name': 'voyagegroup'}) }}">Hello VoyageGroup</a></li>
                <li><a href="{{ urlFor('sweet') }}">ガチャ</a></li>
              </ul>
            </li>
          </ul>
          <ul class="nav navbar-nav navbar-right">
            {% block login %}
              {% if session.get('isLogin') %}
                <li><a href="{{ urlFor('user_edit') }}" >{{ session.get('user.name') }}</a></li>
                <li><a href="{{ urlFor('user_logout') }}">ログアウト</a></li>
              {% else %}
                <li><a href="{{ urlFor('user_login') }}">ログイン</a></li>
                <li><a href="{{ urlFor('user_register') }}">新規登録</a></li>
              {% endif %}
            {% endblock %}
          </ul>
        </div>
      </div>
    </div>
-->
<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <title>おさかな天国</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <!-- Le styles -->
    <link href="/bower_components/bootstrap/dist/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
      padding-top: 70px;
      padding-bottom: 30px;
      }
      #left {
        width:800px;
        height:70%;
        float:left;
      }
      #rare_eria {
        width:400px;
        height:70%;
      }
      #histories {
        float:both;
        height:15%;
      }
    </style>
  </head>

  <body>
    <!-- Fixed navbar -->
    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <a class="navbar-brand" href="/toppage.html">おさかな天国</a>
        </div>
      </div>
    </div>
    <div id= "main" class="container">
	{% block contents '' %}
    <footer>
      <p>&copy; Yuta Iwamoto 2014</p>
     </footer>
    </div> <!-- /container -->
    <script  type="text/javascript" src="http://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script src="/bower_components/vue/dist/vue.js"></script>
    <script src="/bower_components/underscore/underscore.js"></script>
    <script src="/bower_components/bootstrap/dist/js/bootstrap.js"></script>
    <script>
      (function(Vue){
        window.app = new Vue({
          el: '#main',
          data:{
            item: '',
            hist:[],
            allList:[],
            collection:[],
            result:'',
            error:''
          },
          ready: function(){
            var jqxhr = $.ajax({
              url: '../fishgachas.json',
              context: this,
              dataType: 'json'
            })
            .done(function(jqxhr){
              for(var i in jqxhr){
                this.allList.push(jqxhr[i].key);
              }
            })
            .fail(function(){
              this.error = 'ガチャは使えません。';
            });
            return jqxhr;
          },
          methods: {
            gacha: function() {
              this.draw();
              this.result = this.item;
              this.addHistory(this.item);
              this.list(this.allList);
            },
            draw: function() { 
              var jqxhr = $.ajax({
                url: '../fishGet.json',
                context: this,
                dataType: 'json'
              })
              .done(function(jqxhr){
              this.item = jqxhr.key;
              return jqxhr.key;
              })
              .fail(function(){
                this.error = 'ガチャが壊れた.';
              });
            },
            addHistory: function(item){
              this.hist.unshift(item);
            },
            list: function(allList){
              for(var i in allList){
                if (allList[i].value == 0) {
                  this.collection.push(allList[i].key);
                };
              }
              console.log(this.collection);
            },
          }
        });
      })(Vue);
      </script>
      
  </body>
</html>
